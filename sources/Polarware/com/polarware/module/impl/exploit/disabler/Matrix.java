package com.polarware.module.impl.exploit.disabler;

import com.polarware.event.annotations.EventLink;
import com.polarware.event.bus.Listener;
import com.polarware.event.impl.motion.PreMotionEvent;
import com.polarware.event.impl.network.PacketSendEvent;
import com.polarware.module.impl.exploit.DisablerModule;
import com.polarware.util.chat.ChatUtil;
import com.polarware.value.Mode;
import net.minecraft.init.Items;
import net.minecraft.item.ItemStack;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.network.play.client.C0BPacketEntityAction;
import net.minecraft.util.BlockPos;

public class Matrix extends Mode<DisablerModule> {

    public Matrix(String name, DisablerModule parent) {
        super(name, parent);
    }

    @EventLink()
    public final Listener<PreMotionEvent> onPreMotionEvent = event -> {
      //  mc.thePlayer.sendQueue.addToSendQueue(new C08PacketPlayerBlockPlacement(new BlockPos(-1, -1, -1), 255, new ItemStack(Items.water_bucket), 0, 0.5f, 0));
    };

    @EventLink()
    public final Listener<PacketSendEvent> onPacketSend = event -> {
        final Packet<?> p = event.getPacket();

        if (p instanceof C0BPacketEntityAction) {
            final C0BPacketEntityAction wrapper = (C0BPacketEntityAction) p;

            if (wrapper.getAction().equals(C0BPacketEntityAction.Action.START_SPRINTING)) {
                ChatUtil.display("Start " + mc.thePlayer.ticksExisted);
                event.setCancelled(true);
            }

            if (wrapper.getAction().equals(C0BPacketEntityAction.Action.STOP_SPRINTING)) {
                ChatUtil.display("Stop  " + mc.thePlayer.ticksExisted);
                event.setCancelled(true);
            }
        }
    };
}
