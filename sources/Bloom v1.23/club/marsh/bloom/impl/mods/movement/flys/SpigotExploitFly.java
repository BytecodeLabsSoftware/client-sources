package club.marsh.bloom.impl.mods.movement.flys;

import club.marsh.bloom.api.module.Mode;
import club.marsh.bloom.api.module.Module;
import club.marsh.bloom.impl.events.UpdateEvent;
import club.marsh.bloom.impl.utils.movement.MovementUtils;
import club.marsh.bloom.api.value.Value;
import com.google.common.eventbus.Subscribe;

public class SpigotExploitFly extends Mode {

	double enableY = 0, enableX = 0, enableZ = 0;

	public SpigotExploitFly(Module original, String name, Value mode) {
		super(original, name, mode);
	}

	@Override
	public void onEnable() {
		if (!this.canBeUsed())
			return;
		enableY = mc.thePlayer.posY;
		enableX = mc.thePlayer.posX;
		enableZ = mc.thePlayer.posZ;
		if (!mc.thePlayer.onGround) {
			original.addMessage("You must be on ground to use this flight.");
			original.setToggled(false);
		}
	}

	@Subscribe
	public void onUpdate(UpdateEvent e) {
		if (!this.canBeUsed()) return;
		mc.thePlayer.motionX = mc.thePlayer.motionZ = mc.thePlayer.motionY = 0;
		mc.thePlayer.onGround = !mc.thePlayer.movementInput.jump;
		e.ground = false;
		if (mc.thePlayer.ticksExisted % 2 == 0) {
			MovementUtils.setPosition(0.0345/2);
			mc.thePlayer.motionY = mc.thePlayer.movementInput.jump ? 0.01 : mc.thePlayer.movementInput.sneak ? -0.01 : 0;
		}
	}

}
