package club.marsh.bloom.impl.mods.exploit;

import java.util.ArrayList;

import org.lwjgl.input.Keyboard;

import com.google.common.eventbus.Subscribe;

import club.marsh.bloom.api.module.Category;
import club.marsh.bloom.api.module.Module;
import club.marsh.bloom.impl.events.UpdateEvent;
import club.marsh.bloom.impl.events.WorldChangeEvent;
import net.minecraft.client.Minecraft;
import net.minecraft.client.network.NetworkPlayerInfo;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.item.ItemSword;
import net.minecraft.util.ChatComponentText;

public class MurdererFinder extends Module
{
	private ArrayList<String> murderers = new ArrayList<>();
	
	public MurdererFinder()
	{
		super("Murderer Finder", Keyboard.KEY_NONE, Category.EXPLOIT);
	}
	
	@Subscribe
	public void onUpdate(UpdateEvent e)
	{
		try
		{
			for (NetworkPlayerInfo networkPlayerInfo : mc.getNetHandler().getPlayerInfoMap())
			{
				EntityPlayer entityPlayer = mc.theWorld.getPlayerEntityByUUID(networkPlayerInfo.getGameProfile().getId());
				
				if (entityPlayer.equals(mc.thePlayer))
				{
					continue;
				}
				
				if (entityPlayer != null && entityPlayer.getHeldItem() != null && entityPlayer.getHeldItem().getItem() instanceof ItemSword && !this.murderers.contains(entityPlayer.getName()))
				{
					Minecraft.getMinecraft().thePlayer.addChatComponentMessage(new ChatComponentText("\247dBloom \2479>>\247a A murderer has been found: " + entityPlayer.getName()));
					this.murderers.add(entityPlayer.getName());
				}
			}
		}
		
		catch (Exception ee)
		{
		}
	}
	
	@Subscribe
	public void onWorldChange(WorldChangeEvent e)
	{
		this.murderers.clear();
	}
}
