package club.marsh.bloom.impl.mods.exploit;

import club.marsh.bloom.Bloom;
import club.marsh.bloom.api.module.Category;
import club.marsh.bloom.api.module.Module;
import club.marsh.bloom.impl.events.PacketEvent;
import club.marsh.bloom.impl.events.UpdateEvent;
import club.marsh.bloom.impl.ui.hud.impl.BalanceComponent;
import com.google.common.eventbus.Subscribe;
import org.lwjgl.input.Keyboard;


public class BalanceExploit extends Module {
	public long balance, lastPacket;

	public BalanceExploit() {
		super("Balance Exploit",Keyboard.KEY_NONE,Category.EXPLOIT);
	}
	@Override
	public void onEnable() {
		balance = lastPacket = 0;
	}

	@Override
	public void onDisable() {
		mc.timer.timerSpeed = 1f;
	}

	@Subscribe
	public void onUpdate(UpdateEvent e) {
		BalanceComponent balanceGrabber = (BalanceComponent) (Bloom.INSTANCE.hudDesigner.components.stream().filter((comp) -> comp.getName() == "Balance").findFirst().orElse(null));
		if (balanceGrabber.balance < -500) {
			mc.timer.timerSpeed = 2f;
		} else if (balanceGrabber.balance > -100) mc.timer.timerSpeed = 0.75f;
		if (shouldDecreaseBalance())
			mc.timer.timerSpeed = balanceDecreaseTimer();
	}
	public float balanceDecreaseTimer() {
		return 0.265f;
	}
	public boolean shouldDecreaseBalance() {
		return !(mc.thePlayer.movementInput.moveForward != 0 || mc.thePlayer.movementInput.moveStrafe != 0);
	}

	@Subscribe
	public void onPacket(PacketEvent event) {

	}
}
