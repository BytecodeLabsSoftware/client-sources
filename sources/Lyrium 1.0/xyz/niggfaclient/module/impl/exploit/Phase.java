// 
// Decompiled by Procyon v0.5.36
// 

package xyz.niggfaclient.module.impl.exploit;

import xyz.niggfaclient.events.impl.MoveEvent;
import xyz.niggfaclient.utils.player.MoveUtils;
import xyz.niggfaclient.utils.player.PlayerUtil;
import net.minecraft.network.Packet;
import xyz.niggfaclient.utils.network.PacketUtil;
import net.minecraft.network.play.client.C03PacketPlayer;
import xyz.niggfaclient.eventbus.annotations.EventLink;
import xyz.niggfaclient.events.impl.MotionEvent;
import xyz.niggfaclient.eventbus.Listener;
import xyz.niggfaclient.property.Property;
import xyz.niggfaclient.property.impl.EnumProperty;
import xyz.niggfaclient.module.Category;
import xyz.niggfaclient.module.ModuleInfo;
import xyz.niggfaclient.module.Module;

@ModuleInfo(name = "Phase", description = "Allows you walk through blocks/walls", cat = Category.EXPLOIT)
public class Phase extends Module
{
    private final EnumProperty<Mode> mode;
    private final Property<Boolean> sneak;
    @EventLink
    private final Listener<MotionEvent> motionEventListener;
    
    public Phase() {
        this.mode = new EnumProperty<Mode>("Mode", Mode.Normal);
        this.sneak = new Property<Boolean>("Sneak", false);
        final double x;
        final double z;
        this.motionEventListener = (e -> {
            this.setDisplayName(this.getName() + " ยง7" + this.mode.getValue());
            switch (this.mode.getValue()) {
                case Normal: {
                    x = Math.sin(Math.toRadians(this.mc.thePlayer.rotationYaw)) * 0.005;
                    z = Math.cos(Math.toRadians(this.mc.thePlayer.rotationYaw)) * 0.005;
                    if (!this.sneak.getValue() || this.mc.gameSettings.keyBindSneak.isKeyDown()) {
                        if (this.mc.thePlayer.isCollidedHorizontally) {
                            PacketUtil.sendPacketNoEvent(new C03PacketPlayer.C04PacketPlayerPosition(this.mc.thePlayer.posX - x, this.mc.thePlayer.posY, this.mc.thePlayer.posZ + z, true));
                            this.mc.thePlayer.setPosition(this.mc.thePlayer.posX - x, this.mc.thePlayer.posY, this.mc.thePlayer.posZ + z);
                        }
                        if (PlayerUtil.isInsideBlock()) {
                            PacketUtil.sendPacketNoEvent(new C03PacketPlayer.C04PacketPlayerPosition(this.mc.thePlayer.posX + 1.5 * Math.cos(Math.toRadians(this.mc.thePlayer.rotationYaw + 90.0f)), this.mc.thePlayer.posY, this.mc.thePlayer.posZ + 1.5 * Math.sin(Math.toRadians(this.mc.thePlayer.rotationYaw + 90.0f)), true));
                            MoveUtils.setSpeed(null, MoveUtils.getBaseMoveSpeed() / 2.0);
                            break;
                        }
                        else {
                            break;
                        }
                    }
                    else {
                        break;
                    }
                    break;
                }
            }
        });
    }
    
    public enum Mode
    {
        Normal;
    }
}
