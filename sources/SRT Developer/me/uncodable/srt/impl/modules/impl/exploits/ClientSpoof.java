package me.uncodable.srt.impl.modules.impl.exploits;

import io.netty.buffer.Unpooled;
import me.uncodable.srt.Ries;
import me.uncodable.srt.impl.events.api.EventTarget;
import me.uncodable.srt.impl.events.events.packet.EventSendBrand;
import me.uncodable.srt.impl.modules.api.Module;
import me.uncodable.srt.impl.modules.api.ModuleInfo;
import me.uncodable.srt.impl.modules.api.settings.Setting;
import net.minecraft.network.PacketBuffer;
import store.intent.intentguard.annotation.Native;

@ModuleInfo(
   internalName = "ClientSpoof",
   name = "Client Spoof",
   desc = "Allows you to spoof to the server you are using another client.\nThis can lead to automatic bans and/or flags!",
   category = Module.Category.EXPLOIT,
   legit = true
)
public class ClientSpoof extends Module {
   private static final String INTERNAL_CHANNEL_COMBO_BOX = "INTERNAL_CHANNEL_COMBO_BOX";
   private static final String COMBO_BOX_SETTING_NAME = "Client Brand";
   private static final String CHANNEL_SETTING_NAME = "Channel";
   private static final String FORGE = "Forge";
   private static final String SRT = "SRT Hellcat";
   private static final String LUNAR_CLIENT = "Lunar Client";
   private static final String NULL = "Null";
   private static final String NO_BRAND = "No Brand";
   private static final String BEDROCK = "Bedrock";
   private static final String LITE_LOADER = "Lite Loader";
   private static final String BADLION = "Badlion";
   private static final String FABRIC = "Fabric";
   private static final String VANILLA = "Vanilla";
   private static final String CRYSTAL = "Crystal Channel";
   private static final String MC_BRAND = "MC|Brand Channel";
   private static final String MC_BRAND_II = "minecraft:brand Channel";

   public ClientSpoof(int key, boolean enabled) {
      super(key, enabled);
      Ries.INSTANCE
         .getSettingManager()
         .addComboBox(
            this,
            "INTERNAL_GENERAL_COMBO_BOX",
            "Client Brand",
            "Vanilla",
            "Forge",
            "Lunar Client",
            "Bedrock",
            "Lite Loader",
            "Badlion",
            "Fabric",
            "SRT Hellcat",
            "Null",
            "No Brand"
         );
      Ries.INSTANCE
         .getSettingManager()
         .addComboBox(this, "INTERNAL_CHANNEL_COMBO_BOX", "Channel", "MC|Brand Channel", "minecraft:brand Channel", "Crystal Channel");
   }

   @EventTarget(
      target = EventSendBrand.class
   )
   @Native
   public void onBrand(EventSendBrand e) {
      String mode = Ries.INSTANCE.getSettingManager().getSetting(this, "INTERNAL_GENERAL_COMBO_BOX", Setting.Type.COMBO_BOX).getCurrentCombo();
      String mode2 = Ries.INSTANCE.getSettingManager().getSetting(this, "INTERNAL_CHANNEL_COMBO_BOX", Setting.Type.COMBO_BOX).getCurrentCombo();
      switch(mode) {
         case "Fabric":
         case "Badlion":
         case "Bedrock":
         case "Forge":
            e.setDataIn(new PacketBuffer(Unpooled.buffer()).writeString(mode));
            break;
         case "Vanilla":
            e.setDataIn(new PacketBuffer(Unpooled.buffer()).writeString("vanilla"));
            break;
         case "SRT Hellcat":
            e.setDataIn(new PacketBuffer(Unpooled.buffer()).writeString("SRT-Hellcat"));
            break;
         case "Lunar Client":
            e.setDataIn(new PacketBuffer(Unpooled.buffer()).writeString("Lunar"));
            break;
         case "Null":
            e.setDataIn(null);
            break;
         case "Lite Loader":
            e.setDataIn(new PacketBuffer(Unpooled.buffer()).writeString("LiteLoader"));
            break;
         case "No Brand":
            e.setCancelled(true);
            switch(mode2) {
               case "Crystal Channel":
                  e.setChannelIn("CRYSTAL|RIES-SRT");
                  break;
               case "MC|Brand Channel":
                  e.setChannelIn("MC|Brand");
                  break;
               case "minecraft:brand Channel":
                  e.setChannelIn("minecraft:brand");
            }
      }
   }
}
